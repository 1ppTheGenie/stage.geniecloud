import{c as g,o as b,a as i,u as L,s as x,h as v,e as S,f as z,b as c,S as C,j as M,z as w,i as E,t as y,x as O}from"./index.js";import{v as B}from"./index2.js";const I=t=>{if(document.getElementById("google-maps-script"))console.log("initAutocomplete 3"),t();else{var e=document.createElement("script");e.async=!0,e.src=`https://maps.googleapis.com/maps/api/js?key=${window.gHub.googleKey}&libraries=places`,e.id="google-maps-script",e.onload=()=>t(),console.log("js.async!!");var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(e,o)}console.log("initAutocomplete 4")},N=async()=>{await new Promise(t=>{if(document.getElementById("leaflet-script"))(async()=>{for(;!window.L;)await new Promise(n=>setTimeout(n,250));t(!0)})();else{var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css",document.head.appendChild(e);var o=document.createElement("script");o.src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js",o.id="leaflet-script",o.onload=()=>t(!0),document.head.appendChild(o)}})},$=(t,e={})=>{if(window.L&&t&&!t.classList.contains("leaflet-container")){const o=e.center||{lat:32.715,lng:-117.1611},n=e.mapStyle||window.gHub.mapStyle,a=window.L.tileLayer(`https://api.mapbox.com/styles/v1/mapbox/${n}/tiles/{z}/{x}/{y}?access_token=${window.gHub.mapboxKey}`,{attribution:'&copy; <a href="https://www.mapbox.com/feedback/">Mapbox</a>',tileSize:512,zoomOffset:-1});try{return window.L.map(t,{center:[o.lat,o.lng],zoomControl:!1,scrollWheelZoom:!1,layers:[a],attributionControl:!1,zoom:13,dragging:!1,...e})}catch{}}},A=y("<div>"),J=y('<div class="leaflet-pane" style="position:absolute;width:100%;height:100%;display:flex;align-Items:center;justify-Content:center;z-index:9999;">'),p=O(),G=t=>{const[e,o]=g(),{id:n="genie-map",center:a,cssClasses:d,style:u,mapStyle:m,zoom:h}=t;let r;return b(()=>{(async()=>{await N();const s=$(r,{mapStyle:m,center:a?new window.L.LatLng(a[0],a[1]):null,zoom:h,dragPan:!1});s&&o(s);const l=()=>{e()&&e().invalidateSize()};r.addEventListener("transitionend",l),new ResizeObserver(l).observe(document.getElementById(n))})()}),i(()=>{e()&&a&&window.L&&e().panTo(new window.L.LatLng(a[0],a[1]))}),[(()=>{const s=A(),l=r;return typeof l=="function"?L(l,s):r=s,x(s,"id",n),v(s,d),S(f=>z(s,u,f)),s})(),c(C,{get when(){return e()},get children(){return c(p.Provider,{value:e,get children(){return t.children}})}})]},k=t=>{const[e]=M(t.areaId,B);return c(P,{get polygon(){return e()},get color(){return t.color}})},P=t=>{const[e,o]=g(),n=w(p),{fitBounds:a=!0,fillColor:d="#E9B760"}=t;return i(()=>{n&&t.polygon&&typeof t.polygon.geoJSON<"u"&&o(JSON.parse(t.polygon.geoJSON))}),i(()=>{e()&&window.L.geoJSON(e(),{style:()=>({color:d}),onEachFeature:(u,m)=>{a&&(n().fitBounds(m.getBounds(),{zoom:22}),n().invalidateSize())}}).addTo(n())}),null},H=t=>(()=>{const e=J();return E(e,()=>t.children),e})(),R=({color:t,caption:e,position:o})=>c(T,{position:o}),T=t=>{const e=w(p),{position:o}=t;return i(()=>{e()&&o&&window.L&&window.L.marker(o,{...t}).addTo(e())}),null};export{R as C,k as G,G as L,T as M,H as a,$ as b,I as c,N as i};
//# sourceMappingURL=LeafletMap.js.map
