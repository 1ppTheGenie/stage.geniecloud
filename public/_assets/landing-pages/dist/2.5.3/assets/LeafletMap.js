import{c as g,o as x,a as i,u as b,s as v,n as L,e as S,f as $,b as c,S as C,h as M,z as w,i as E,k as N,t as y,x as O}from"./index.js";import{A as z}from"./index2.js";const R=t=>{if(document.getElementById("google-maps-script"))t();else{var e=document.createElement("script");e.async=!0,e.src=`https://maps.googleapis.com/maps/api/js?key=${window.gHub.googleKey}&libraries=places`,e.id="google-maps-script",e.onload=()=>t();var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}},B=async()=>{await new Promise(t=>{if(document.getElementById("leaflet-script"))(async()=>{for(;!window.L;)await new Promise(o=>setTimeout(o,250));t(!0)})();else{var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css",document.head.appendChild(e);var n=document.createElement("script");n.src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js",n.id="leaflet-script",n.onload=()=>t(!0),document.head.appendChild(n)}})},A=(t,e={})=>{if(window.L&&t&&!t.classList.contains("leaflet-container")){const n=e.center||{lat:32.715,lng:-117.1611},o=e.mapStyle||window.gHub.mapStyle,a=window.L.tileLayer(`https://api.mapbox.com/styles/v1/mapbox/${o}/tiles/{z}/{x}/{y}?access_token=${window.gHub.mapboxKey}`,{attribution:'&copy; <a href="https://www.mapbox.com/feedback/">Mapbox</a>',tileSize:512,zoomOffset:-1});try{return window.L.map(t,{center:[n.lat,n.lng],zoomControl:!1,scrollWheelZoom:!1,layers:[a],attributionControl:!1,zoom:13,dragging:!1,...e})}catch{}}},I=y("<div>"),T=y('<div class="leaflet-pane" style="position:absolute;width:100%;height:100%;display:flex;align-Items:center;justify-Content:center;z-index:9999;">'),m=O(),j=t=>{const[e,n]=g(),{id:o="genie-map",center:a,cssClasses:d,style:u,mapStyle:f,zoom:h}=t;let l;return x(()=>{(async()=>{await B();const s=A(l,{mapStyle:f,center:a?new window.L.LatLng(a[0],a[1]):null,zoom:h,dragPan:!1});s&&n(s);const r=()=>{e()&&e().invalidateSize()};l.addEventListener("transitionend",r),new ResizeObserver(r).observe(document.getElementById(o))})()}),i(()=>{e()&&a&&window.L&&e().panTo(new window.L.LatLng(a[0],a[1]))}),[(()=>{const s=I(),r=l;return typeof r=="function"?b(r,s):l=s,v(s,"id",o),L(s,d),S(p=>$(s,u,p)),s})(),c(C,{get when(){return e()},get children(){return c(m.Provider,{value:e,get children(){return t.children}})}})]},H=t=>{const[e]=M(t.areaId,z);return c(G,{get polygon(){return e()},get color(){return t.color}})},G=t=>{const[e,n]=g(),o=w(m),{fitBounds:a=!0,fillColor:d="#E9B760"}=t;return i(()=>{o&&t.polygon&&typeof t.polygon.geoJSON<"u"&&n(JSON.parse(t.polygon.geoJSON))}),i(()=>{e()&&window.L.geoJSON(e(),{style:()=>({color:d}),onEachFeature:(u,f)=>{a&&(o().fitBounds(f.getBounds(),{zoom:22}),o().invalidateSize())}}).addTo(o())}),null},U=t=>(()=>{const e=T();return E(e,()=>t.children),e})(),D=({color:t,caption:e,position:n})=>{const o=P(t,e),a=window.L&&new window.L.icon({iconUrl:o,iconSize:[34,34],iconAnchor:[12,12]});return c(J,{position:n,icon:a})},J=t=>{const e=w(m);return i(()=>{if(!e()||!t.position||!window.L)return;const n=window.L.marker(t.position,{...t}).addTo(e());N(()=>{e().removeLayer(n)})}),null},P=(t,e="",n=12)=>{const o=e===""?"":`<text x="12" y="16" fill="#fff" text-anchor="middle" style="font-family:sans-serif;font-weight:800;font-size:12px">${e}</text>`,a=`
	<svg xmlns="http://www.w3.org/2000/svg" width="${n*2+4}" height="${n*2+4}">
		<defs>
			<filter id="shadow" x="0" y="0" width="${n}" height="${n}">
				<feGaussianBlur in="SourceAlpha" stdDeviation="3"/> 
				<feOffset dx="2" dy="2" result="offsetblur"/>
				<feComponentTransfer>
					<feFuncA type="linear" slope="0.5"/>
				</feComponentTransfer>
				<feMerge> 
					<feMergeNode/> 
					<feMergeNode in="SourceGraphic"/> 
				</feMerge>
			</filter>
		</defs>
		<circle fill="${t}" cx="${n}" cy="${n}" r="${n}" filter="url(#shadow)" />
		${o}
	</svg>`;return"data:image/svg+xml,"+encodeURIComponent(a)};export{D as C,H as G,j as L,J as M,U as a,A as b,R as c,B as i};
//# sourceMappingURL=LeafletMap.js.map
